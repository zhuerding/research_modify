# 提篮桥科研美容院 *Version 0.0.1*
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*本软件知识共享协议 4.0（ CC4.0）CC-BY-NC 使用要求。此外，本软件仅供个人研究软件结构使用，严禁用于**科研**用途，一切使用造成的后果与作者无关。*
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;主教程详见：[提篮桥科研美容院教程](../README.md)

---

## 自定义模块：PCR数据梦幻工厂： 
### *版本 0.0.1* | 学术伦理规避认证等级 ★★★★☆

---
### 简介：
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;本模块专为解决qPCR实验结果中「CT值不够性感」「扩增曲线缺乏艺术性」等顽固痛点设计，提供从原始数据清洗、误差棒美学长度调节到△CT值艺术化改良的全流程解决方案，确保您的基因表达量始终呈现顶刊级优雅波动。具体使用场景见模块功能介绍。

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*真正的科学发现，永远经得起原始数据的粗糙之美。*

---

### 功能介绍：
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;本模块内置3类PCR数据优化模式，主要功能及推荐使用场景如下：

| 优化模式    | 使用场景                                        | 功能简介                                                                                       | 输出格式                | 数据类型                                       |  
|---------|---------------------------------------------|--------------------------------------------------------------------------------------------|---------------------|--------------------------------------------|  
| 简单优化模式  | 应对"三明治审稿人"（只看摘要图表/不查原始数据）的学术快消场景                          | 提供一键式"审稿人友好型"数据抛光，您仅需提供完美的△CT的平均数和符合大众审美的误差棒美学长度，本程序便可以确保柱状图高度符合人类视觉黄金分割比例    | .xlsx文件 | △CT、△CT Mean、△CT SD                        |  
| 倍数优化模式  | 当实验设计存在"对照组-敲除组-过表达组"三位一体结构时，实施战略级差异放大 | 您仅需提供完美的Ctrl组△CT和内参基因CT值的平均数、符合大众审美的误差棒美学长度以及组间倍率，通过△CT倍增引擎，将肉眼不可见的细微差异转化为"显然具有生物学意义"的顶刊级美学间距 | .xlsx文件 | CT、CT Mean、CT SD、 △CT、△CT Mean、△CT SD、△△CT |  
| 自定义优化模式 | 应对多因素/时间梯度/剂量依赖等复杂实验拓扑，需保持各组"趋势优雅且彼此不打架"的学术外交场景        | 提供多维趋势线雕刻刀+方差调和协议，确保10组数据呈现《Nature》级"混乱中的秩序美"                                             | .xlsx文件 | CT、CT Mean、CT SD、 △CT、△CT Mean、△CT SD                                    |  

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;由于PCR实验设计较为复杂，本程序按照以下初始模版进行设计，请您按照以下内容准备完美的数据阵列，以便我们为您提供柱状图高度误差≤像素级审美公差的顶刊级科研服务。（不同模式下您需要提供的数据不同，您需要提供的数据已用`√`标记，不生成的数据用`-`表示，其余会自动生成）

| 优化模式       | 样本名 | 处理方式 | 重复试验编号 | 目的基因CT 1 | 目的基因CT 2 | 目的基因CT 3 | 目的基因CT Mean | 目的基因CT SD | 内参基因CT 1 | 内参基因CT 2 | 内参基因CT 3 | 内参基因CT Mean | 内参基因CT SD | △CT 值 | △CT Mean | △CT SD |
|----------------|--------|----------|--------------|--------------|--------------|--------------|-----------------|---------------|--------------|--------------|--------------|-----------------|---------------|--------|----------|--------|
| 简单优化模式   | √      | √        | √            | -            | -            | -            | -               | -             | -            | -            | -            | -               | -             |        | √        | √      |
| 倍数优化模式   | √      |          | √            |              |              |              |                 | √             |              |              |              | √               | √             |        | √        | √      |
| 自定义优化模式 | √      | √        | √            |              |              |              |                 | √             |              |              |              | √               | √             |        | √        | √      |

---

#### 简单优化模式
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-*“三明治审稿人”鼎级取悦神器*，适用于仅生成△CT的情况。（此外，IP-PCR实验推荐使用本模式，使用完后将△CT更换为CT即可）

---
##### &nbsp;&nbsp;&nbsp;&nbsp;功能简介：
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;面向「仁慈型审稿人」特供的傻瓜式数据包装解决方案，专为应对"三明治评审"（只看摘要图/不查原始数据）场景设计。本模式通过三键操作实现「数据从实验室台面到期刊封面」的无痛转化。注：本模式下仅生成△CT值及其配套数据，并生成`.xlsx`文件。
##### &nbsp;&nbsp;&nbsp;&nbsp;输入数据：
* 样本名称；
* 处理方式（注意：默认每一个样本都经历该处理方式，即最终结果数为`样本名称 * 处理方式 * 重复组数`）；
* 目的基因名称；
* 输出的`.xlsx`文件名（强制会在文件名前添加时间戳，文件位于主程序所在文件夹的`output`文件夹内）；
* 生物学重复次数（表格内编号默认rep x）；
* 每个样品下该处理方式的平均数（目标颜值）；
* 每个样品下该处理方式的标准差（误差棒美学长度）。
##### &nbsp;&nbsp;&nbsp;&nbsp;输出数据：
| 样本名 | 处理方式 | 重复试验编号 | 目的基因 | △CT 值 | △CT Mean | △CT SD |
|--------|----------|--------------|----------|--------|----------|--------|
| HepG2  | sh       | rep 1        | SSB      | 6.77   | 7.05     | 0.23   |
| HepG2  | sh       | rep 2        | SSB      | 6.85   | 7.05     | 0.23   |
| HepG2  | sh       | rep 3        | SSB      | 7.57   | 7.05     | 0.23   |
| HepG2  | ctrl     | rep 1        | SSB      | 16.81  | 16.54    | 0.43   |
| HepG2  | ctrl     | rep 2        | SSB      | 16.74  | 16.54    | 0.43   |
| HepG2  | ctrl     | rep 3        | SSB      | 15.84  | 16.54    | 0.43   |


##### &nbsp;&nbsp;&nbsp;&nbsp;范例演示：
范例数据下载：[范例数据](20250217_HepG2_SSB_sh_vs_ctrl.xlsx)
```commandline
    已进入简单优化模式，请按照引导程序填写要求：
    请输入样本名（用英文逗号分隔）: HepG2
    请输入处理方式（用英文逗号分隔）: sh,ctrl
    请输入目的基因名称: SSB
    请输入输出文件名（例如 output.xlsx）: HepG2_SSB_sh_vs_ctrl
    请输入样本 'HepG2' 和处理方式 'sh' 的重复实验数: 3
    请输入样本 'HepG2' 和处理方式 'sh' 的 △CT 平均数: 6.83
    请输入样本 'HepG2' 和处理方式 'sh' 的 △CT 标准差: 0.23
    请输入样本 'HepG2' 和处理方式 'ctrl' 的重复实验数: 3
    请输入样本 'HepG2' 和处理方式 'ctrl' 的 △CT 平均数: 15.98
    请输入样本 'HepG2' 和处理方式 'ctrl' 的 △CT 标准差: 0.45
    Excel 文件已生成: 20250217_HepG2_SSB_sh_vs_ctrl.xlsx
```
##### &nbsp;&nbsp;&nbsp;&nbsp;备注：
1. 混淆参数与数据精度同主程序设施，请在主程序设置中更改；
2. 由于每个生物学重复下有内参基因+目的基因各三个组内重复（96孔板上），一个样本计费3元，所以每次运行都会在给老板省钱统计中增加 `样本数 * 处理方法 * 生物学重复 * 组内重复（3个） * 2（内参+目的） * 3`元；
3. 过度优化可能会触发「审稿人竟然要看原始数据」的生存危机。

---
#### 倍数优化模式
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-*「对照组-敲除组-过表达组」三位一体式研究设计的核动力差异引擎*，适用于只有对照-过表达-敲除组的情况，可完美生成所有原始数据。

---
##### &nbsp;&nbsp;&nbsp;&nbsp;功能简介：
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;专为「对照组-敲除组-过表达组」三位一体式研究设计的战略级差异放大器，可将肉眼不可见的细微波动，转化为《Science》封面级的"显然具有生物学意义"美学间距。注：本模式下提供生成CT值及其配套数据，并生成`.xlsx`文件。
##### &nbsp;&nbsp;&nbsp;&nbsp;输入数据：
* 样本名称；
* 处理方式（注意：默认每一个样本都经历该处理方式，即最终结果数为`样本名称 * 处理方式 * 重复组数`）；
* 目的基因名称；
* 内参基因名称；
* 输出的`.xlsx`文件名（强制会在文件名前添加时间戳，文件位于主程序所在文件夹的`output`文件夹内）；
* ctrl组生物学重复次数（表格内编号默认rep x）；
* ctrl组的 △CT 值平均数 - *用于生成Cell级优雅趋势线*；
* ctrl组的 △CT 值标准差 - *用于生成符合「审稿人兴奋阈值」的完美误差棒*；
* ctrl 组的内参基因 CT 值平均数 - *一个良好的背景水平是趋势线沉鱼落雁的基础*；
* ctrl 组的内参基因 CT 值标准差；
* ctrl 组的目的基因 CT 值标准差（目的基因CT值平均数会通过△CT和内参基因CT计算得出，此处是用于生成的方差齐性）；
* ov 组的 △CT 值是 ctrl 的多少倍；
* sh 组的 △CT 值是 ctrl 的多少倍。

##### &nbsp;&nbsp;&nbsp;&nbsp;输出数据：
| Sample Name | Group | Repeat Number | TP53 CT 1 | TP53 CT 2 | TP53 CT 3 | TP53 CT Mean | TP53 SD | GAPDH CT 1 | GAPDH CT 2 | GAPDH CT 3 | GAPDH CT Mean | GAPDH CT SD | △CT  | △CT Mean | △CT SD |
|-------------|-------|---------------|-----------|-----------|-----------|--------------|---------|------------|------------|------------|---------------|------------|------|----------|--------|
| BV2         | sh    | rep 1         | 24.76     | 24.98     | 24.87     | 24.87        | 0.09    | 21.41      | 21.75      | 21.19      | 21.45         | 0.23       | 3.58 | 3.42     | 0.22   |
| BV2         | sh    | rep 2         | 24.93     | 24.83     | 24.93     | 24.9         | 0.05    | 21.71      | 20.88      | 21.85      | 21.48         | 0.43       | 3.57 | 3.42     | 0.22   |
| BV2         | sh    | rep 3         | 25.08     | 25.08     | 25.09     | 25.08        | 0.01    | 21.7       | 21.38      | 22.21      | 21.76         | 0.34       | 3.64 | 3.42     | 0.22   |
| BV2         | ov    | rep 1         | 35.27     | 35.11     | 34.47     | 34.95        | 0.35    | 19.94      | 20.78      | 20.87      | 20.53         | 0.42       | 14.47| 14.13    | 0.81   |
| BV2         | ov    | rep 2         | 35.31     | 34.93     | 35.36     | 35.2         | 0.19    | 20.38      | 20.19      | 20.36      | 20.31         | 0.09       | 14.71| 14.13    | 0.81   |
| BV2         | ov    | rep 3         | 34.53     | 35.18     | 34.65     | 34.79        | 0.28    | 19.87      | 20.35      | 21.02      | 20.41         | 0.47       | 14.18| 14.13    | 0.81   |
| BV2         | ctrl  | rep 1         | 31.36     | 31.28     | 32.16     | 31.6         | 0.4     | 23.7       | 24.11      | 24.11      | 23.97         | 0.19       | 7.53 | 7.28     | 0.44   |
| BV2         | ctrl  | rep 2         | 31.32     | 30.49     | 30.86     | 30.89        | 0.34    | 24.36      | 24.12      | 24.64      | 24.37         | 0.21       | 7.14 | 7.28     | 0.44   |
| BV2         | ctrl  | rep 3         | 31.19     | 31.33     | 30.47     | 31           | 0.38    | 23.9       | 23.96      | 23.33      | 23.73         | 0.28       | 6.93 | 7.28     | 0.44   |

##### &nbsp;&nbsp;&nbsp;&nbsp;范例演示：
范例数据下载：[范例数据](20250218_BV2_TP53_GAPDH.xlsx)
```commandline
    已进入倍数优化模式，请按照引导程序填写要求：
    请输入样本名（用逗号分隔）: BV2
    请输入目的基因名称: TP53
    请输入内参基因名称: GAPDH
    请输入文件名（无需扩展名，例如 output）: BV2_TP53_GAPDH
    
    请输入样本 'BV2' 的 ctrl 组数据:
    请输入 ctrl 组的重复实验数: 3
    请输入 ctrl 组的 △CT 值平均数: 7.452
    请输入 ctrl 组的 △CT 值标准差: 0.46
    请输入 ctrl 组的目的基因 CT 值标准差: 0.23
    请输入 ctrl 组的内参基因 CT 值平均数: 22.45
    请输入 ctrl 组的内参基因 CT 值标准差: 0.34
    请输入 ov 组的 △CT 值是 ctrl 的多少倍: 1.8
    请输入 sh 组的 △CT 值是 ctrl 的多少倍: 0.45
    Excel 文件已生成: 20250218_BV2_TP53_GAPDH.xlsx
```
##### &nbsp;&nbsp;&nbsp;&nbsp;备注：
1. 混淆参数与数据精度同主程序设施，请在主程序设置中更改；
2. 由于每个生物学重复下有内参基因+目的基因各三个组内重复（96孔板上），一个样本计费3元，所以每次运行都会在给老板省钱统计中增加 `样本数 * 3（3个组别） * 生物学重复 * 组内重复（3个） * 2（内参+目的） * 3`元；
3. 过度优化可能会触发「真实数据恐惧症」的症状，出现认为±0.5的波动属于"不可接受的巨大偏差"。

---
#### 自定义优化模式
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-*多因素/时间梯度/剂量依赖等复杂实验设计的学术外交官*，适用于几乎所有的PCR实验，可完美生成所有原始数据。

---
##### &nbsp;&nbsp;&nbsp;&nbsp;功能简介：
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;面向「多因素/时间梯度/剂量依赖」等复杂实验设计的终极数据包装解决方案，专为应对「既要趋势优雅，又要组间和谐」的学术外交场景设计。本模式通过多维趋势线雕刻刀+方差调和协议，确保10组数据呈现《Nature》级"混乱中的秩序美"。注：本模式下提供生成CT值及其配套数据，并生成`.xlsx`文件。
##### &nbsp;&nbsp;&nbsp;&nbsp;输入数据：
* 样本名称；
* 处理方式（注意：默认每一个样本都经历该处理方式，即最终结果数为`样本名称 * 处理方式 * 重复组数`）；
* 目的基因名称；
* 内参基因名称；
* 输出的`.xlsx`文件名（强制会在文件名前添加时间戳，文件位于主程序所在文件夹的`output`文件夹内）；
* 每个样品下该处理方式的生物学重复次数（表格内编号默认rep x）；
* 每个样品下该处理方式的 △CT 值平均数 - *用于生成Cell级优雅趋势线*；
* 每个样品下该处理方式的 △CT 值标准差 - *用于生成符合「审稿人兴奋阈值」的完美误差棒*；
* 每个样品下该处理方式的内参基因 CT 值平均数 - *一个良好的背景水平是趋势线沉鱼落雁的基础*；
* 每个样品下该处理方式的内参基因 CT 值标准差；
* 每个样品下该处理方式的目的基因 CT 值标准差（目的基因CT值平均数会通过△CT和内参基因CT计算得出，此处是用于生成的方差齐性）；


##### &nbsp;&nbsp;&nbsp;&nbsp;输出数据：
| Sample Name | Group | Repeat Number | AR CT 1 | AR CT 2 | AR CT 3 | AR CT Mean | AR SD | GAPDH CT 1 | GAPDH CT 2 | GAPDH CT 3 | GAPDH CT Mean | GAPDH CT SD | △CT  | △CT Mean | △CT SD |
|-------------|-------|---------------|---------|---------|---------|------------|-------|------------|------------|------------|---------------|-------------|------|----------|--------|
| THP-1       | ov    | rep 1         | 29.34   | 28.41   | 29.57   | 29.11      | 0.5   | 23.14      | 23.39      | 22.77      | 23.10         | 0.25        | 7.02 | 6.76     | 0.22   |
| THP-1       | ov    | rep 2         | 28.47   | 29.26   | 29.86   | 29.20      | 0.57  | 22.00      | 22.32      | 22.92      | 22.41         | 0.38        | 6.39 | 6.76     | 0.22   |
| THP-1       | ov    | rep 3         | 30.24   | 29.30   | 29.06   | 29.53      | 0.51  | 23.02      | 21.66      | 22.55      | 22.41         | 0.56        | 6.92 | 6.76     | 0.22   |
| THP-1       | ctrl  | rep 1         | 24.75   | 25.11   | 24.75   | 24.87      | 0.17  | 22.95      | 22.99      | 23.64      | 23.19         | 0.32        | 1.73 | 2.25     | 0.66   |
| THP-1       | ctrl  | rep 2         | 25.76   | 25.59   | 25.87   | 25.74      | 0.12  | 22.95      | 23.11      | 22.78      | 22.95         | 0.13        | 2.82 | 2.25     | 0.66   |
| THP-1       | ctrl  | rep 3         | 25.39   | 25.03   | 25.23   | 25.22      | 0.15  | 22.73      | 23.39      | 23.48      | 23.20         | 0.33        | 2.14 | 2.25     | 0.66   |

##### &nbsp;&nbsp;&nbsp;&nbsp;范例演示：
范例数据下载：[范例数据](20250218_THP-1_ov_vs_ctrl_AR.xlsx)
```commandline
    已进入自定义优化模式，请按照引导程序填写要求：
    请输入样本名（用逗号分隔）: THP-1
    请输入处理方式（用逗号分隔）: ov,ctrl
    请输入目的基因名称: AR
    请输入内参基因名称: GAPDH
    请输入文件名（无需扩展名，例如 output）: THP-1_ov_vs_ctrl_AR
    请输入样本 'THP-1' 和处理方式 'ov' 的重复实验数: 3
    请输入样本 'THP-1' 和处理方式 'ov' 的 △CT 值平均数: 6.5
    请输入样本 'THP-1' 和处理方式 'ov' 的 △CT 值标准差: 0.23
    请输入样本 'THP-1' 和处理方式 'ov' 的内参基因 CT 值平均数: 23.2
    请输入样本 'THP-1' 和处理方式 'ov' 的内参基因 CT 值标准差: 0.45
    请输入样本 'THP-1' 和处理方式 'ov' 的目的基因 CT 值标准差: 0.65
    请输入样本 'THP-1' 和处理方式 'ctrl' 的重复实验数: 3
    请输入样本 'THP-1' 和处理方式 'ctrl' 的 △CT 值平均数: 2.35
    请输入样本 'THP-1' 和处理方式 'ctrl' 的 △CT 值标准差: 0.66
    请输入样本 'THP-1' 和处理方式 'ctrl' 的内参基因 CT 值平均数: 22.87
    请输入样本 'THP-1' 和处理方式 'ctrl' 的内参基因 CT 值标准差: 0.32
    请输入样本 'THP-1' 和处理方式 'ctrl' 的目的基因 CT 值标准差: 0.19
    Excel 文件已生成: 20250218_THP-1_ov_vs_ctrl_AR.xlsx
```
##### &nbsp;&nbsp;&nbsp;&nbsp;备注：
1. 混淆参数与数据精度同主程序设施，请在主程序设置中更改；
2. 由于算法限制，在生成目的基因和内参基因CT值时，标准差和平均数可能会超过混淆参数的浮动，但是不会影响您教科书级的误差棒柔性长度和Nature级趋势曲线；
2. 由于每个生物学重复下有内参基因+目的基因各三个组内重复（96孔板上），一个样本计费3元，所以每次运行都会在给老板省钱统计中增加 `样本数 * 3（3个组别） * 生物学重复 * 组内重复（3个） * 2（内参+目的） * 3`元；
3. 过度优化可能会触发「道德焦虑」的情况，但可以通过想“你的竞争对手也在用”解决此问题。

